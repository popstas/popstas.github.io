<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>ansible on Popstas</title><link>https://blog.popstas.ru/tags/ansible/</link><description>Recent content in ansible on Popstas</description><generator>Hugo -- gohugo.io</generator><language>ru-ru</language><lastBuildDate>Sun, 31 Dec 2017 01:30:00 +0600</lastBuildDate><atom:link href="https://blog.popstas.ru/tags/ansible/index.xml" rel="self" type="application/rss+xml"/><item><title>Итоги 2017 года</title><link>https://blog.popstas.ru/blog/2017/12/31/new-year-2018/</link><pubDate>Sun, 31 Dec 2017 01:30:00 +0600</pubDate><guid>https://blog.popstas.ru/blog/2017/12/31/new-year-2018/</guid><description>&lt;p>Решил зафиксировать уходящий год и вспомнить, что было. Давно хотелось иметь такую шпаргалку, чтобы вспоминать, в каком же году это было. К счастью, в этом году перед долгой новогодней ночью нам достались выходные, использую их для этой записи.&lt;/p>
&lt;img itemprop="image" src="https://blog.popstas.ru/images/2017-12/new-year.jpg" />
&lt;meta property="og:image" content="https://blog.popstas.ru/images/2017-12/new-year.jpg" /></description></item><item><title>Packer: создаем свои vagrant box и docker image из одного конфига</title><link>https://blog.popstas.ru/blog/2017/03/26/packer-create-vagrant-box-from-ansible-playbook/</link><pubDate>Sun, 26 Mar 2017 21:30:00 +0000</pubDate><guid>https://blog.popstas.ru/blog/2017/03/26/packer-create-vagrant-box-from-ansible-playbook/</guid><description>&lt;p>Проект &lt;a href="https://github.com/viasite-ansible/ansible-server">viasite-ansible/ansible-server&lt;/a> подошел к моменту,
когда нужно протестировать роль, которая зависит сразу от нескольких ролей (роль установки сайта).&lt;/p>
&lt;p>Естественно, при тестировании этой роли я не хочу ждать по 10 минут каждый раз,
поэтому &lt;del>я потратил день&lt;/del> я вспомнил, что есть такой тул - &lt;a href="https://www.packer.io/">Packer&lt;/a>
и решил, что пришло его время.&lt;/p>
&lt;p>Packer умеет брать чистую операционку, настраивать ее и упаковывать результат в образ системы для использования в других
программах или разворачивания на хостинге.&lt;/p>
&lt;p>Для чего это может пригодиться:&lt;/p>
&lt;ul>
&lt;li>ускорение тестирования&lt;/li>
&lt;li>б&lt;strong>о&lt;/strong>льшая повторяемость, по сравнению с ansible&lt;/li>
&lt;li>образы для продакшена для быстрого развертывания новых серверов&lt;/li>
&lt;li>образы идентичные продакшену для локальной разработки&lt;/li>
&lt;/ul>
&lt;p>Tl;dr: я буду собирать образы для Docker и Vagrant из Ubuntu, на которую накатили ansible плейбук.
Gist с результатами &lt;a href="https://gist.github.com/popstas/9a42d198fe7c5bee317d0bc4e2e2af9f">здесь&lt;/a>.&lt;/p>
&lt;img itemprop="image" src="https://blog.popstas.ru/images/2017-03/ansible-packer-docker-vagrant.png" />
&lt;meta property="og:image" content="https://blog.popstas.ru/images/2017-03/ansible-packer-docker-vagrant.png" /></description></item><item><title>Мой процесс написания ansible роли с Molecule и Gitlab CI</title><link>https://blog.popstas.ru/blog/2017/03/08/develop-ansible-roles-with-molecule-and-gitlab-ci/</link><pubDate>Wed, 08 Mar 2017 01:00:00 +0000</pubDate><guid>https://blog.popstas.ru/blog/2017/03/08/develop-ansible-roles-with-molecule-and-gitlab-ci/</guid><description>&lt;p>Опишу процесс, к которому я пришел на данный момент.&lt;/p>
&lt;p>TODO: concurrent
TODO: несколько дистрибов&lt;/p>
&lt;h4 id="особенности">Особенности&lt;/h4>
&lt;ul>
&lt;li>Стремление не писать роли&lt;/li>
&lt;li>Постепенное ужесточение требований при написании, от &amp;ldquo;Лишь бы прошло с 10 раза&amp;rdquo; к &amp;ldquo;Скорее всего Travis пройдет с первого раза&amp;rdquo;&lt;/li>
&lt;li>Тестирование на разных машинах&lt;/li>
&lt;/ul>
&lt;img itemprop="image" src="https://blog.popstas.ru/images/2017-03/iterations.png" />
&lt;meta property="og:image" content="https://blog.popstas.ru/images/2017-03/iterations.png" /></description></item><item><title>Настройка кеширующего прокси apt-cacher-ng для ускорения тестирования ansible ролей с Molecule, Gitlab CI и Docker</title><link>https://blog.popstas.ru/blog/2017/02/26/apt-cacher-ng-for-testing-ansible-roles-with-docker-and-gitlab-ci/</link><pubDate>Sun, 26 Feb 2017 04:14:00 +0000</pubDate><guid>https://blog.popstas.ru/blog/2017/02/26/apt-cacher-ng-for-testing-ansible-roles-with-docker-and-gitlab-ci/</guid><description>&lt;p>В &lt;a href="https://blog.popstas.ru/blog/2017/02/24/why-you-should-not-use-apt-mirror-for-ansible-tests-in-docker/">предыдущей статье&lt;/a> я настраивал &lt;code>apt-mirror&lt;/code> для тех же целей. У того способа нашлось несколько недостатков.&lt;/p>
&lt;p>В статье ниже описано, как решить ту же проблему, используя &lt;code>apt-cacher-ng&lt;/code>.&lt;/p>
&lt;p>Tl;dr: на этот раз все получилось, этот способ меня устроил.&lt;/p>
&lt;img itemprop="image" src="https://blog.popstas.ru/images/2017-02/apt-cacher-ng.png" />
&lt;meta property="og:image" content="https://blog.popstas.ru/images/2017-02/apt-cacher-ng.png" /></description></item><item><title>Как я создал и отказался от локального репозитория apt-mirror для Ubuntu для ускорения тестирования ansible ролей</title><link>https://blog.popstas.ru/blog/2017/02/24/why-you-should-not-use-apt-mirror-for-ansible-tests-in-docker/</link><pubDate>Fri, 24 Feb 2017 17:39:00 +0000</pubDate><guid>https://blog.popstas.ru/blog/2017/02/24/why-you-should-not-use-apt-mirror-for-ansible-tests-in-docker/</guid><description>&lt;p>При тестировании плейбуков на чистой Ubuntu (а как же еще?) самые большие накладные расходы по времени (субъективно)
и уж точно самые большие по трафику уходят на установку пакетов из системного репозитория. Особенно это заметно, когда видишь, что один и тот же тест Travis CI прогоняет в 1.5 раза быстрее.&lt;/p>
&lt;p>Ниже описано, как создать зеркало из &lt;a href="http://mirror.yandex.ru/ubuntu">http://mirror.yandex.ru/ubuntu&lt;/a> и подружить его с Gitlab CI и molecule.&lt;/p>
&lt;p>Tl;dr: не делайте локальный репозиторий через &lt;code>apt-mirror&lt;/code> для мелких задач, не стоит оно того. Вместо этого нужно поднять кеширующий сервер через &lt;a href="https://blog.popstas.ru/blog/2017/02/26/apt-cacher-ng-for-testing-ansible-roles-with-docker-and-gitlab-ci/">apt-cacher-ng&lt;/a>.&lt;/p>
&lt;img itemprop="image" src="https://blog.popstas.ru/images/2017-02/apt-mirror.png" />
&lt;meta property="og:image" content="https://blog.popstas.ru/images/2017-02/apt-mirror.png" /></description></item><item><title>Извлечение одной из папок в git репозитории в отдельный репозиторий с сохранением истории - git-extract-subproject</title><link>https://blog.popstas.ru/blog/2017/02/22/2017/02/22/git-extract-subproject-preserving-history/</link><pubDate>Wed, 22 Feb 2017 01:19:00 +0000</pubDate><guid>https://blog.popstas.ru/blog/2017/02/22/2017/02/22/git-extract-subproject-preserving-history/</guid><description>&lt;p>Занялся я тут распиливанием большого проекта (дерево ansible ролей) на отдельные репозитории.&lt;/p>
&lt;h3 id="для-этого-надо">Для этого надо:&lt;/h3>
&lt;ol>
&lt;li>Извлечь директорию подпроекта в отдельный репозиторий&lt;/li>
&lt;li>Удалить из проекта папку подпроекта&lt;/li>
&lt;li>Добавить в большой проект зависимость от подпроекта&lt;/li>
&lt;/ol>
&lt;p>Ниже написано, как сделать 1-й шаг одной командой через скрипт &lt;code>git-extract-subproject&lt;/code>.&lt;/p>
&lt;img itemprop="image" src="https://blog.popstas.ru/images/2017-02/git-extract-subproject.jpg" />
&lt;meta property="og:image" content="https://blog.popstas.ru/images/2017-02/git-extract-subproject.jpg" /></description></item><item><title>Kapacitor: часть 1. Введение, сравнение с Monit, установка с Ansible и без, настройка</title><link>https://blog.popstas.ru/blog/2016/05/19/kapacitor-ansible-install-monit-comparsion/</link><pubDate>Thu, 19 May 2016 00:47:52 +0000</pubDate><guid>https://blog.popstas.ru/blog/2016/05/19/kapacitor-ansible-install-monit-comparsion/</guid><description>&lt;p>Несколько недель назад я начал разбираться с Kapacitor, попутно записывая свои действия. Конца разбирательствам было не видно, записей становилось все больше и накопилось на серию.&lt;/p>
&lt;p>Речь пойдет о Kapacitor, последнеем слое из стека &lt;a href="https://influxdata.com/get-started/what-is-the-tick-stack/">TICK&lt;/a> от InfluxData, набора программ для сбора, отображения и обработке метрик.&lt;/p>
&lt;p>Tl;dr: думаю, что Kapacitor нужен только тем, кто уже использует InfluxDB для сбора метрик. С установкой могут быть проблемы, если руки кривые.&lt;/p>
&lt;p>А также небольшое замечание о том, &lt;a href="https://blog.popstas.ru/blog/2016/05/19/kapacitor-ansible-install-monit-comparsion/#github-pull-request">как делать Pull request'ы из браузера за 2 минуты&lt;/a>&lt;/p>
&lt;img itemprop="image" src="https://blog.popstas.ru/images/2016-05/kapacitor.svg" />
&lt;meta property="og:image" content="https://blog.popstas.ru/images/2016-05/kapacitor.svg" /></description></item></channel></rss>